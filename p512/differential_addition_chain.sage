ells = [ 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101,
	103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 
	223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 
	349, 353, 359, 367, 373, 587];
p = 4 * prod(ells) - 1;
G.<a>=GF(p^2,name='a',modulus=x^2+1);
A = 6;
#A = 3660531689687144537798649124765796265922835935302812894295885379832752438089867533337299606759071662303728117187051820332336016283001207986531180645517342;
E = EllipticCurve(G,[0,A,0,1,0]);

# Point doubling
def xDBL(X1, Z1, A24, C24):
	t0 = X1 - Z1; t1 = X1 + Z1;
	t0 = t0**2 ;
	t1 = t1**2 ;
	Z1 = C24 * t0;
	X1 = t1 * Z1;
	t1 = t1 - t0;
	t0 = A24 * t1;
	Z1 = Z1 + t0;
	Z1 = Z1 * t1;
	return X1, Z1;

# Point addition
def xADD(X1, Z1, X2, Z2, X3, Z3):
	t0 = X1 + Z1; t1 = X1 - Z1;
	t2 = X2 - Z2; 
	X5 = X2 + Z2;
	t0 = t0 * t2;
	t1 = t1 * X5;
	Z5 = t0 - t1;
	X5 = t0 + t1;
	Z5 = Z5**2 ;
	X5 = X5**2 ;
	Z5 = X3 * Z5;
	X5 = Z3 * X5;
	return X5, Z5;

Chain = [2 , 1 , 1 , 0 ,
3 , 2 , 1 , 1 ,
4 , 3 , 1 , 2 ,
5 , 4 , 3 , 1 ,
6 , 4 , 4 , 0 ,
7 , 6 , 5 , 1 ,
8 , 7 , 5 , 6 ,
9 , 8 , 7 , 5 ,
10 , 8 , 8 , 0 ,
11 , 10 , 9 , 5 ,
12 , 10 , 10 , 0 ,
13 , 12 , 11 , 5 ,
14 , 13 , 12 , 11 ,
15 , 14 , 12 , 13 ,
16 , 15 , 14 , 12 ,
17 , 16 , 15 , 14 ,
18 , 17 , 16 , 15 ,
19 , 18 , 17 , 16 ,
20 , 19 , 18 , 17 ,
21 , 20 , 19 , 18 ,
22 , 21 , 19 , 20 ,
23 , 22 , 21 , 19 ,
24 , 23 , 22 , 21 ,
25 , 24 , 23 , 22 ,
26 , 24 , 24 , 0 ,
27 , 26 , 25 , 22 ,
28 , 27 , 26 , 25 ,
29 , 27 , 27 , 0 ,
30 , 29 , 28 , 25 ,
31 , 30 , 29 , 28 ,
32 , 30 , 30 , 0 ,
33 , 32 , 31 , 28 ,
34 , 33 , 32 , 31 ,
35 , 34 , 32 , 33 ,
36 , 35 , 34 , 32 ,
37 , 36 , 35 , 34 ,
38 , 37 , 35 , 36 ,
39 , 38 , 37 , 35 ,
40 , 39 , 38 , 37 ,
41 , 40 , 39 , 38 ,
42 , 41 , 40 , 39 ,
43 , 42 , 40 , 41 ,
44 , 43 , 42 , 40 ,
45 , 44 , 43 , 42 ,
46 , 45 , 44 , 43 ,
47 , 46 , 44 , 45 ,
48 , 46 , 46 , 0 ,
49 , 47 , 46 , 44 ,
50 , 49 , 48 , 44 ,
51 , 50 , 48 , 49 ,
52 , 51 , 48 , 50 ,
53 , 52 , 48 , 51 ,
54 , 53 , 52 , 48 ,
55 , 54 , 52 , 53 ,
56 , 54 , 53 , 52 ,
57 , 56 , 48 , 55 ,
58 , 56 , 56 , 0 ,
59 , 58 , 56 , 56 ,
60 , 58 , 57 , 55 ,
61 , 60 , 48 , 59 ,
62 , 60 , 60 , 0 ,
63 , 62 , 61 , 59 ,
64 , 62 , 62 , 0 ,
65 , 64 , 63 , 59 ,
66 , 65 , 64 , 63 ,
67 , 66 , 65 , 64 ,
68 , 67 , 65 , 66 ,
69 , 67 , 66 , 65 ,
70 , 69 , 68 , 64 ,
71 , 70 , 69 , 68 ,
72 , 71 , 70 , 69 ,
73 , 72 , 71 , 70 ,
74 , 73 , 71 , 72 ,
75 , 74 , 73 , 71 ,
76 , 75 , 74 , 73 ,
77 , 76 , 74 , 75 ,
78 , 77 , 76 , 74 ,
79 , 78 , 76 , 77 ,
80 , 79 , 76 , 78 ,
81 , 80 , 79 , 76 ,
82 , 81 , 80 , 79 ,
83 , 81 , 81 , 0 ,
84 , 82 , 82 , 0 ,
85 , 83 , 82 , 79 ,
86 , 85 , 84 , 79 ,
87 , 85 , 85 , 0 ,
88 , 87 , 86 , 79 ,
89 , 88 , 87 , 86 ,
90 , 89 , 88 , 87 ,
91 , 90 , 89 , 88 ,
92 , 91 , 90 , 89 ,
93 , 91 , 91 , 0 ,
94 , 93 , 92 , 89 ,
95 , 93 , 93 , 0 ,
96 , 94 , 94 , 0 ,
97 , 95 , 94 , 89 ,
98 , 97 , 96 , 89 ,
99 , 98 , 97 , 96 ,
100 , 98 , 98 , 0 ,
101 , 99 , 98 , 97 ,
102 , 101 , 100 , 97 ,
103 , 102 , 101 , 100 ,
104 , 103 , 102 , 101 ,
105 , 103 , 103 , 0 ,
106 , 105 , 104 , 101 ,
107 , 106 , 105 , 104 ,
108 , 107 , 105 , 106 ,
109 , 108 , 107 , 105 ,
110 , 109 , 107 , 108 ,
111 , 110 , 109 , 107 ,
112 , 111 , 110 , 109 ,
113 , 112 , 111 , 110 ,
114 , 113 , 111 , 112 ,
115 , 113 , 112 , 111 ,
116 , 115 , 114 , 110 ,
117 , 115 , 115 , 0 ,
118 , 117 , 116 , 110 ,
119 , 118 , 116 , 117 ,
120 , 119 , 116 , 118 ,
121 , 120 , 119 , 116 ,
122 , 120 , 120 , 0 ,
123 , 122 , 121 , 116 ,
124 , 123 , 121 , 122 ,
125 , 124 , 123 , 121 ,
126 , 125 , 123 , 124 ,
127 , 125 , 124 , 123 ,
128 , 127 , 126 , 121 ,
129 , 128 , 126 , 127 ,
130 , 129 , 126 , 128 ,
131 , 130 , 129 , 126 ,
132 , 131 , 129 , 130 ,
133 , 132 , 131 , 129 ,
134 , 133 , 132 , 131 ,
135 , 134 , 132 , 133 ,
136 , 135 , 134 , 132 ,
137 , 136 , 135 , 134 ,
138 , 137 , 135 , 136 ,
139 , 138 , 137 , 135 ,
140 , 139 , 138 , 137 ,
141 , 140 , 139 , 138 ,
142 , 141 , 140 , 139 ,
143 , 142 , 141 , 140 ,
144 , 143 , 142 , 141 ,
145 , 143 , 143 , 0 ,
146 , 145 , 144 , 141 ,
147 , 145 , 145 , 0 ,
148 , 146 , 146 , 0 ,
149 , 147 , 146 , 141 ,
150 , 149 , 148 , 141 ,
151 , 150 , 148 , 149 ,
152 , 151 , 150 , 148 ,
153 , 152 , 150 , 151 ,
154 , 153 , 152 , 150 ,
155 , 154 , 153 , 152 ,
156 , 155 , 154 , 153 ,
157 , 155 , 155 , 0 ,
158 , 157 , 155 , 155 ,
159 , 157 , 156 , 153 ,
160 , 159 , 158 , 154 ,
161 , 160 , 159 , 158 ,
162 , 161 , 159 , 160 ,
163 , 161 , 161 , 0 ,
164 , 163 , 161 , 161 ,
165 , 163 , 162 , 160 ,
166 , 165 , 164 , 159 ,
167 , 165 , 165 , 0 ,
168 , 166 , 166 , 0 ,
169 , 167 , 166 , 159 ,
170 , 169 , 168 , 159 ,
171 , 169 , 169 , 0 ,
172 , 171 , 170 , 159 ,
173 , 171 , 171 , 0 ,
174 , 173 , 172 , 159 ,
175 , 174 , 172 , 173 ,
176 , 175 , 174 , 172 ,
177 , 176 , 174 , 175 ,
178 , 177 , 174 , 176 ,
179 , 178 , 177 , 174 ,
180 , 179 , 177 , 178 ,
181 , 180 , 177 , 179 ,
182 , 181 , 177 , 180 ,
183 , 182 , 181 , 177 ,
184 , 183 , 182 , 181 ,
185 , 184 , 183 , 182 ,
186 , 184 , 184 , 0 ,
187 , 186 , 185 , 182 ,
188 , 187 , 186 , 185 ,
189 , 188 , 186 , 187 ,
190 , 189 , 188 , 186 ,
191 , 190 , 189 , 188 ,
192 , 190 , 190 , 0 ,
193 , 192 , 190 , 190 ,
194 , 192 , 191 , 188 ,
195 , 194 , 193 , 189 ,
196 , 195 , 194 , 193 ,
197 , 196 , 194 , 195 ,
198 , 197 , 196 , 194 ,
199 , 198 , 197 , 196 ,
200 , 199 , 197 , 198 ,
201 , 200 , 199 , 197 ,
202 , 201 , 199 , 200 ,
203 , 202 , 201 , 199 ,
204 , 203 , 201 , 202 ,
205 , 204 , 203 , 201 ,
206 , 205 , 203 , 204 ,
207 , 206 , 205 , 203 ,
208 , 207 , 206 , 205 ,
209 , 208 , 207 , 206 ,
210 , 209 , 208 , 207 ,
211 , 210 , 209 , 208 ,
212 , 211 , 209 , 210 ,
213 , 211 , 210 , 209 ,
214 , 213 , 212 , 208 ,
215 , 214 , 213 , 212 ,
216 , 215 , 214 , 213 ,
217 , 216 , 214 , 215 ,
218 , 217 , 214 , 216 ,
219 , 217 , 217 , 0 ,
220 , 218 , 217 , 214 ,
221 , 220 , 219 , 214 ,
222 , 221 , 220 , 219 ,
223 , 222 , 220 , 221 ,
224 , 222 , 222 , 0 ,
225 , 224 , 222 , 222 ,
226 , 224 , 223 , 221 ,
227 , 226 , 225 , 220 ,
228 , 227 , 226 , 225 ,
229 , 228 , 227 , 226 ,
230 , 228 , 228 , 0 ,
231 , 230 , 229 , 226 ,
232 , 231 , 229 , 230 ,
233 , 232 , 231 , 229 ,
234 , 233 , 231 , 232 ,
235 , 234 , 231 , 233 ,
236 , 235 , 234 , 231 ,
237 , 236 , 234 , 235 ,
238 , 237 , 234 , 236 ,
239 , 238 , 237 , 234 ,
240 , 239 , 238 , 237 ,
241 , 240 , 239 , 238 ,
242 , 241 , 240 , 239 ,
243 , 242 , 241 , 240 ,
244 , 243 , 241 , 242 ,
245 , 244 , 243 , 241 ,
246 , 245 , 243 , 244 ,
247 , 246 , 245 , 243 ,
248 , 247 , 246 , 245 ,
249 , 248 , 247 , 246 ,
250 , 249 , 248 , 247 ,
251 , 249 , 249 , 0 ,
252 , 251 , 250 , 247 ,
253 , 252 , 251 , 250 ,
254 , 253 , 251 , 252 ,
255 , 254 , 251 , 253 ,
256 , 254 , 254 , 0 ,
257 , 256 , 253 , 255 ,
258 , 256 , 254 , 254 ,
259 , 258 , 257 , 251 ,
260 , 259 , 258 , 257 ,
261 , 260 , 259 , 258 ,
262 , 260 , 260 , 0 ,
263 , 262 , 261 , 258 ,
264 , 262 , 262 , 0 ,
265 , 264 , 263 , 258 ,
266 , 264 , 264 , 0 ,
267 , 265 , 265 , 0 ,
268 , 266 , 265 , 258 ,
269 , 268 , 267 , 258 ,
270 , 269 , 268 , 267 ,
271 , 270 , 268 , 269 ,
272 , 271 , 270 , 268 ,
273 , 271 , 271 , 0 ,
274 , 273 , 272 , 268 ,
275 , 274 , 273 , 272 ,
276 , 275 , 274 , 273 ,
277 , 276 , 275 , 274 ,
278 , 276 , 276 , 0 ,
279 , 278 , 277 , 274 ,
280 , 279 , 278 , 277 ,
281 , 280 , 278 , 279 ,
282 , 281 , 280 , 278 ,
283 , 282 , 281 , 280 ,
284 , 283 , 282 , 281 ,
285 , 283 , 283 , 0 ,
286 , 285 , 284 , 281 ,
287 , 285 , 285 , 0 ,
288 , 287 , 286 , 281 ,
289 , 288 , 287 , 286 ,
290 , 289 , 287 , 288 ,
291 , 289 , 289 , 0 ,
292 , 291 , 288 , 290 ,
293 , 291 , 289 , 289 ,
294 , 293 , 292 , 287 ,
295 , 294 , 292 , 293 ,
296 , 294 , 294 , 0 ,
297 , 295 , 294 , 292 ,
298 , 297 , 296 , 292 ,
299 , 298 , 297 , 296 ,
300 , 299 , 298 , 297 ,
301 , 299 , 299 , 0 ,
302 , 301 , 300 , 297 ,
303 , 301 , 301 , 0 ,
304 , 303 , 302 , 297 ,
305 , 304 , 303 , 302 ,
306 , 304 , 304 , 0 ,
307 , 306 , 305 , 302 ,
308 , 307 , 305 , 306 ,
309 , 307 , 306 , 305 ,
310 , 309 , 308 , 302 ,
311 , 310 , 308 , 309 ,
312 , 311 , 310 , 308 ,
313 , 312 , 311 , 310 ,
314 , 312 , 312 , 0 ,
315 , 314 , 313 , 310 ,
316 , 315 , 313 , 314 ,
317 , 316 , 315 , 313 ,
318 , 317 , 315 , 316 ,
319 , 318 , 317 , 315 ,
320 , 319 , 317 , 318 ,
321 , 320 , 319 , 317 ,
322 , 321 , 319 , 320 ,
323 , 321 , 320 , 319 ,
324 , 323 , 322 , 317 ,
325 , 324 , 323 , 322 ,
326 , 325 , 324 , 323 ,
327 , 326 , 324 , 325 ,
328 , 326 , 325 , 324 ,
329 , 328 , 327 , 323 ,
330 , 328 , 328 , 0 ,
331 , 330 , 329 , 323 ,
332 , 330 , 330 , 0 ,
333 , 332 , 331 , 323 ,
334 , 333 , 331 , 332 ,
335 , 333 , 332 , 331 ,
336 , 335 , 334 , 323 ,
337 , 335 , 335 , 0 ,
338 , 337 , 336 , 323 ,
339 , 337 , 337 , 0 ,
340 , 339 , 323 , 338 ,
341 , 339 , 339 , 0 ,
342 , 341 , 338 , 340 ,
343 , 342 , 341 , 338 ,
344 , 343 , 342 , 341 ,
345 , 344 , 343 , 342 ,
346 , 345 , 344 , 343 ,
347 , 346 , 345 , 344 ,
348 , 347 , 345 , 346 ,
349 , 348 , 347 , 345 ,
350 , 349 , 348 , 347 ,
351 , 350 , 348 , 349 ,
352 , 351 , 350 , 348 ,
353 , 352 , 350 , 351 ,
354 , 353 , 352 , 350 ,
355 , 354 , 353 , 352 ,
356 , 355 , 353 , 354 ,
357 , 356 , 355 , 353 ,
358 , 356 , 356 , 0 ,
359 , 358 , 357 , 353 ,
360 , 359 , 358 , 357 ,
361 , 359 , 359 , 0 ,
362 , 361 , 360 , 357 ,
363 , 361 , 361 , 0 ,
364 , 363 , 362 , 357 ,
365 , 364 , 362 , 363 ,
366 , 365 , 364 , 362 ,
367 , 365 , 365 , 0 ,
368 , 367 , 366 , 362 ,
369 , 368 , 366 , 367 ,
370 , 369 , 368 , 366 ,
371 , 370 , 369 , 368 ,
372 , 371 , 369 , 370 ,
373 , 372 , 371 , 369 ,
374 , 373 , 371 , 372 ,
375 , 373 , 373 , 0 ,
376 , 375 , 373 , 373 ,
377 , 375 , 374 , 372 ,
378 , 377 , 376 , 371 ,
379 , 378 , 377 , 376 ,
380 , 379 , 378 , 377 ,
381 , 380 , 379 , 378 ,
382 , 381 , 380 , 379 ,
383 , 382 , 381 , 380 ,
384 , 383 , 382 , 381 ,
385 , 383 , 383 , 0 ,
386 , 385 , 384 , 381 ,
387 , 385 , 385 , 0 ,
388 , 387 , 386 , 381 ,
389 , 387 , 387 , 0 ,
390 , 389 , 388 , 381 ,
391 , 390 , 388 , 389 ,
392 , 390 , 389 , 388 ,
393 , 392 , 391 , 381 ,
394 , 392 , 392 , 0 ,
395 , 394 , 393 , 381 ,
396 , 394 , 394 , 0 ,
397 , 396 , 395 , 381 ,
398 , 397 , 395 , 396 ,
399 , 398 , 397 , 395 ,
400 , 399 , 397 , 398 ,
401 , 399 , 398 , 397 ,
402 , 401 , 400 , 395 ,
403 , 402 , 401 , 400 ,
404 , 403 , 402 , 401 ,
405 , 403 , 403 , 0 ,
406 , 405 , 404 , 401 ,
407 , 406 , 404 , 405 ,
408 , 406 , 405 , 404 ,
409 , 408 , 407 , 401 ,
410 , 409 , 408 , 407 ,
411 , 410 , 408 , 409 ,
412 , 411 , 410 , 408 ,
413 , 412 , 411 , 410 ,
414 , 413 , 412 , 411 ,
415 , 413 , 413 , 0 ,
416 , 414 , 414 , 0 ,
417 , 415 , 414 , 411 ,
418 , 417 , 416 , 411 ,
419 , 418 , 416 , 417 ,
420 , 419 , 418 , 416 ,
421 , 420 , 419 , 418 ,
422 , 421 , 419 , 420 ,
423 , 422 , 421 , 419 ,
424 , 423 , 421 , 422 ,
425 , 424 , 423 , 421 ,
426 , 425 , 424 , 423 ,
427 , 425 , 425 , 0 ,
428 , 426 , 426 , 0 ,
429 , 427 , 426 , 423 ,
430 , 429 , 428 , 423 ,
431 , 430 , 429 , 428 ,
432 , 431 , 429 , 430 ,
433 , 432 , 431 , 429 ,
434 , 432 , 432 , 0 ,
435 , 434 , 433 , 429 ,
436 , 434 , 434 , 0 ,
437 , 436 , 435 , 429 ,
438 , 437 , 436 , 435 ,
439 , 437 , 437 , 0 ,
440 , 439 , 438 , 435 ,
441 , 440 , 438 , 439 ,
442 , 441 , 438 , 440 ,
443 , 442 , 441 , 438 ,
444 , 442 , 442 , 0 ,
445 , 444 , 443 , 438 ,
446 , 445 , 443 , 444 ,
447 , 446 , 443 , 445 ,
448 , 447 , 446 , 443 ,
449 , 448 , 447 , 446 ,
450 , 449 , 447 , 448 ,
451 , 450 , 449 , 447 ,
452 , 451 , 450 , 449 ,
453 , 452 , 450 , 451 ,
454 , 453 , 452 , 450 ,
455 , 454 , 453 , 452 ,
456 , 455 , 454 , 453 ,
457 , 456 , 455 , 454 ,
458 , 457 , 456 , 455 ,
459 , 458 , 457 , 456 ,
460 , 459 , 458 , 457 ,
461 , 460 , 459 , 458 ,
462 , 461 , 460 , 459 ,
463 , 462 , 461 , 460 ,
464 , 463 , 462 , 461 ,
465 , 464 , 463 , 462 ,
466 , 465 , 464 , 463 ,
467 , 466 , 465 , 464 ,
468 , 467 , 466 , 465 ,
469 , 468 , 467 , 466 ,
470 , 469 , 468 , 467 ,
471 , 470 , 469 , 468 ,
472 , 471 , 470 , 469 ,
473 , 472 , 471 , 470 ,
474 , 473 , 472 , 471 ,
475 , 474 , 473 , 472 ,
476 , 475 , 474 , 473 ,
477 , 476 , 475 , 474 ,
478 , 477 , 476 , 475 ,
479 , 478 , 477 , 476 ,
480 , 479 , 478 , 477 ,
481 , 480 , 479 , 478 ,
482 , 481 , 480 , 479 ,
483 , 482 , 481 , 480 ,
484 , 483 , 482 , 481 ,
485 , 484 , 483 , 482 ,
486 , 485 , 484 , 483 ,
487 , 486 , 485 , 484 ,
488 , 487 , 486 , 485 ,
489 , 488 , 487 , 486 ,
490 , 489 , 488 , 487 ,
491 , 490 , 489 , 488 ,
492 , 491 , 490 , 489 ,
493 , 492 , 491 , 490 ,
494 , 493 , 492 , 491 ,
495 , 494 , 493 , 492 ,
496 , 495 , 494 , 493 ,
497 , 496 , 495 , 494 ,
498 , 497 , 496 , 495 ,
499 , 498 , 497 , 496 ,
500 , 499 , 498 , 497 ,
501 , 500 , 499 , 498 ,
502 , 501 , 500 , 499 ,
503 , 502 , 501 , 500 ,
504 , 503 , 502 , 501 ,
505 , 504 , 503 , 502 ,
506 , 505 , 504 , 503 ,
507 , 506 , 505 , 504 ,
508 , 507 , 506 , 505 ,
509 , 508 , 507 , 506 ,
510 , 509 , 508 , 507 ,
511 , 510 , 509 , 508 ,
512 , 511 , 510 , 509 ,
513 , 512 , 511 , 510 ,
514 , 513 , 512 , 511 ,
515 , 514 , 513 , 512 ,
516 , 515 , 514 , 513 ,
517 , 516 , 515 , 514 ,
518 , 517 , 516 , 515 ,
519 , 518 , 517 , 516 ,
520 , 519 , 518 , 517 ,
521 , 520 , 519 , 518 ,
522 , 521 , 520 , 519 ,
523 , 522 , 521 , 520 ,
524 , 523 , 522 , 521 ,
525 , 524 , 523 , 522 ,
526 , 525 , 524 , 523 ,
527 , 526 , 525 , 524 ,
528 , 527 , 526 , 525 ,
529 , 528 , 527 , 526 ,
530 , 529 , 528 , 527 ,
531 , 530 , 529 , 528 ,
532 , 531 , 530 , 529 ,
533 , 532 , 531 , 530 ,
534 , 533 , 532 , 531 ,
535 , 534 , 533 , 532 ,
536 , 535 , 534 , 533 ,
537 , 536 , 535 , 534 ,
538 , 537 , 536 , 535 ,
539 , 538 , 537 , 536 ,
540 , 539 , 538 , 537 ,
541 , 540 , 539 , 538 ,
542 , 541 , 540 , 539 ,
543 , 542 , 541 , 540 ,
544 , 543 , 542 , 541 ,
545 , 544 , 543 , 542 ,
546 , 545 , 544 , 543 ,
547 , 546 , 545 , 544 ,
548 , 547 , 546 , 545 ,
549 , 548 , 547 , 546 ,
550 , 549 , 548 , 547 ,
551 , 550 , 549 , 548 ,
552 , 551 , 550 , 549 ,
553 , 552 , 551 , 550 ,
554 , 553 , 552 , 551 ,
555 , 554 , 553 , 552 ,
556 , 555 , 554 , 553 ,
557 , 556 , 555 , 554 ,
558 , 557 , 556 , 555 ,
559 , 558 , 557 , 556 ,
560 , 559 , 558 , 557 ,
561 , 560 , 559 , 558 ,
562 , 561 , 560 , 559 ,
563 , 562 , 561 , 560 ,
564 , 563 , 562 , 561 ,
565 , 564 , 563 , 562 ,
566 , 565 , 564 , 563 ,
567 , 566 , 565 , 564 ,
568 , 567 , 566 , 565 ,
569 , 568 , 567 , 566 ,
570 , 569 , 568 , 567 ,
571 , 570 , 569 , 568 ,
572 , 571 , 570 , 569 ,
573 , 572 , 571 , 570 ,
574 , 573 , 572 , 571 ,
575 , 574 , 573 , 572 ,
576 , 575 , 574 , 573 ,
577 , 576 , 575 , 574 ,
578 , 577 , 576 , 575 ,
579 , 578 , 577 , 576 ,
580 , 579 , 578 , 577 ,
581 , 580 , 579 , 578 ,
582 , 581 , 580 , 579 ,
583 , 582 , 581 , 580 ,
584 , 583 , 582 , 581 ,
585 , 584 , 583 , 582 ,
586 , 585 , 584 , 583 ,
587 , 586 , 585 , 584 ,
588 , 587 , 586 , 585 ,
589 , 588 , 587 , 586 ,
590 , 589 , 588 , 587 ,
591 , 590 , 589 , 588 ,
592 , 591 , 590 , 589 ,
593 , 592 , 591 , 590 ,
594 , 593 , 592 , 591 ,
595 , 594 , 593 , 592 ,
596 , 595 , 594 , 593 ,
597 , 596 , 595 , 594 ,
598 , 597 , 596 , 595 ,
599 , 598 , 597 , 596 ,
600 , 599 , 598 , 597 ,
601 , 600 , 599 , 598 ,
602 , 601 , 600 , 599 ,
603 , 602 , 601 , 600 ,
604 , 603 , 602 , 601 ,
605 , 604 , 603 , 602 ,
606 , 605 , 604 , 603 ,
607 , 606 , 605 , 604 ,
608 , 607 , 606 , 605 ,
609 , 608 , 607 , 606 ,
610 , 609 , 608 , 607 ,
611 , 610 , 609 , 608 ,
612 , 611 , 610 , 609 ,
613 , 612 , 611 , 610 ,
614 , 613 , 612 , 611 ,
615 , 614 , 613 , 612 ,
616 , 615 , 614 , 613 ,
617 , 616 , 615 , 614 ,
618 , 617 , 616 , 615 ,
619 , 618 , 617 , 616 ,
620 , 619 , 618 , 617 ,
621 , 620 , 619 , 618 ,
622 , 621 , 620 , 619 ,
623 , 622 , 621 , 620 ,
624 , 623 , 622 , 621 ,
625 , 624 , 623 , 622 ,
626 , 625 , 624 , 623 ,
627 , 626 , 625 , 624 ,
628 , 627 , 626 , 625 ,
629 , 628 , 627 , 626 ,
630 , 629 , 628 , 627 ,
631 , 630 , 629 , 628 ,
632 , 631 , 630 , 629 ,
633 , 632 , 631 , 630 ,
634 , 633 , 632 , 631 ,
635 , 634 , 633 , 632 ,
636 , 635 , 634 , 633 ,
637 , 636 , 635 , 634 ,
638 , 637 , 636 , 635 ,
639 , 638 , 637 , 636 ,
640 , 639 , 638 , 637 ,
641 , 640 , 639 , 638 ,
642 , 641 , 640 , 639 ,
643 , 642 , 641 , 640 ,
644 , 643 , 642 , 641 ,
645 , 644 , 643 , 642 ,
646 , 645 , 644 , 643 ,
647 , 646 , 645 , 644 ,
648 , 647 , 646 , 645 ,
649 , 648 , 647 , 646 ,
650 , 649 , 648 , 647 ,
651 , 650 , 649 , 648 ,
652 , 651 , 650 , 649 ,
653 , 652 , 651 , 650 ,
654 , 653 , 652 , 651 ,
655 , 654 , 653 , 652 ,
656 , 655 , 654 , 653 ,
657 , 656 , 655 , 654 ,
658 , 657 , 656 , 655 ,
659 , 658 , 657 , 656 ,
660 , 659 , 658 , 657 ,
661 , 660 , 659 , 658 ,
662 , 661 , 660 , 659 ,
663 , 662 , 661 , 660 ,
664 , 663 , 662 , 661 ,
665 , 664 , 663 , 662 ,
666 , 665 , 664 , 663 ,
667 , 666 , 665 , 664 ,
668 , 667 , 666 , 665 ,
669 , 668 , 667 , 666 ,
670 , 669 , 668 , 667 ,
671 , 670 , 669 , 668 ,
672 , 671 , 670 , 669 ,
673 , 672 , 671 , 670 ,
674 , 673 , 672 , 671 ,
675 , 674 , 673 , 672 ,
676 , 675 , 674 , 673 ,
677 , 676 , 675 , 674 ,
678 , 677 , 676 , 675 ,
679 , 678 , 677 , 676 ,
680 , 679 , 678 , 677 ,
681 , 680 , 679 , 678 ,
682 , 681 , 680 , 679 ,
683 , 682 , 681 , 680 ,
684 , 683 , 682 , 681 ,
685 , 684 , 683 , 682 ,
686 , 685 , 684 , 683 ,
687 , 686 , 685 , 684 ,
688 , 687 , 686 , 685 ,
689 , 688 , 687 , 686 ,
690 , 689 , 688 , 687 ,
691 , 690 , 689 , 688 ,
692 , 691 , 690 , 689 ,
693 , 692 , 691 , 690 ,
694 , 693 , 692 , 691 ,
695 , 694 , 693 , 692 ,
696 , 695 , 694 , 693 ,
697 , 696 , 695 , 694 ,
698 , 697 , 696 , 695 ,
699 , 698 , 697 , 696 ,
700 , 699 , 698 , 697 ,
701 , 700 , 699 , 698 ,
702 , 701 , 700 , 699 ,
703 , 702 , 701 , 700 ,
704 , 703 , 702 , 701 ,
705 , 704 , 703 , 702 ,
706 , 705 , 704 , 703 ,
707 , 706 , 705 , 704 ,
708 , 707 , 706 , 705 ,
709 , 708 , 707 , 706 ,
710 , 709 , 708 , 707 ,
711 , 710 , 709 , 708 ,
712 , 711 , 710 , 709 ,
713 , 712 , 711 , 710 ,
714 , 713 , 712 , 711 ,
715 , 714 , 713 , 712 ,
716 , 715 , 714 , 713 ,
717 , 716 , 715 , 714 ,
718 , 717 , 716 , 715 ,
719 , 718 , 717 , 716 ,
720 , 719 , 718 , 717 ,
721 , 720 , 719 , 718 ,
722 , 721 , 720 , 719 ,
723 , 722 , 721 , 720 ,
724 , 723 , 722 , 721 ,
725 , 724 , 723 , 722 ,
726 , 725 , 724 , 723 ,
727 , 726 , 725 , 724 ,
728 , 727 , 726 , 725 ,
729 , 728 , 727 , 726 ,
730 , 729 , 728 , 727 ,
731 , 730 , 729 , 728 ,
732 , 731 , 730 , 729 ,
733 , 732 , 731 , 730 ,
734 , 733 , 732 , 731 ,
735 , 734 , 733 , 732 ,
736 , 735 , 734 , 733 ,
737 , 736 , 735 , 734 ,
738 , 737 , 736 , 735 ,
739 , 738 , 737 , 736 ,
740 , 739 , 738 , 737 ,
741 , 740 , 739 , 738 ,
742 , 741 , 740 , 739 ,
743 , 742 , 741 , 740 ,
744 , 743 , 742 , 741 ,
745 , 744 , 743 , 742 ,
746 , 745 , 744 , 743 ,
747 , 746 , 745 , 744 ,
748 , 747 , 746 , 745 ,
749 , 748 , 747 , 746 ,
750 , 749 , 748 , 747 ,
751 , 750 , 749 , 748 ,
752 , 751 , 750 , 749 ,
753 , 752 , 751 , 750 ,
754 , 753 , 752 , 751 ,
755 , 754 , 753 , 752 ,
756 , 755 , 754 , 753 ,
757 , 756 , 755 , 754 ,
758 , 757 , 756 , 755 ,
759 , 758 , 757 , 756 ,
760 , 759 , 758 , 757 ,
761 , 760 , 759 , 758 ,
762 , 761 , 760 , 759 ,
763 , 762 , 761 , 760 ,
764 , 763 , 762 , 761 ,
765 , 764 , 763 , 762 ,
766 , 765 , 764 , 763 ,
767 , 766 , 765 , 764 ,
768 , 767 , 766 , 765 ,
769 , 768 , 767 , 766 ,
770 , 769 , 768 , 767 ,
771 , 770 , 769 , 768 ,
772 , 771 , 770 , 769 ,
773 , 772 , 771 , 770 ,
774 , 773 , 772 , 771 ,
775 , 774 , 773 , 772 ,
776 , 775 , 774 , 773 ,
777 , 776 , 775 , 774 ,
778 , 777 , 776 , 775 ,
779 , 778 , 777 , 776 ,
780 , 779 , 778 , 777 ,
781 , 780 , 779 , 778 ,
782 , 781 , 780 , 779 ,
783 , 782 , 781 , 780 ,
784 , 783 , 782 , 781 ,
785 , 784 , 783 , 782 ,
786 , 785 , 784 , 783 ,
787 , 786 , 785 , 784 ,
788 , 787 , 786 , 785 ,
789 , 788 , 787 , 786 ,
790 , 789 , 788 , 787 ,
791 , 790 , 789 , 788 ,
792 , 791 , 790 , 789 ,
793 , 792 , 791 , 790 ,
794 , 793 , 792 , 791 ,
795 , 794 , 793 , 792 ,
796 , 795 , 794 , 793 ,
797 , 796 , 795 , 794 ,
798 , 797 , 796 , 795 ,
799 , 798 , 797 , 796 ,
800 , 799 , 798 , 797 ,
801 , 800 , 799 , 798 ,
802 , 801 , 800 , 799 ,
803 , 802 , 801 , 800 ,
804 , 803 , 802 , 801 ,
805 , 804 , 803 , 802 ,
806 , 805 , 804 , 803 ];
chain_len = 807-2;
chain_nontrivial_len = len(Chain)/4;
cost_count_for_new_method = [0,0];

def AC_scalar(XP, ZP, A):
    XX = [1, XP]; ZZ = [0, ZP];
    A24 = A + G(2);
    C24 = G(4);
    for i in range(chain_nontrivial_len):
        l1 = Chain[4*i+1]; l2 = Chain[4*i+2]; l3 = Chain[4*i+3];
        X1 = XX[l1]; Z1 = ZZ[l1]; X2 = XX[l2];  Z2 = ZZ[l2]; X3 = XX[l3]; Z3 = ZZ[l3];
        if Z3 == 0:
            [X0, Z0] = xDBL(X1,Z1,A24,C24); 
            cost_count_for_new_method[0] = cost_count_for_new_method[0] + 3;
            cost_count_for_new_method[1] = cost_count_for_new_method[1] + 2;
        else:
            [X0, Z0] = xADD(X1, Z1, X2, Z2, X3, Z3);
            cost_count_for_new_method[0] = cost_count_for_new_method[0] + 4;
            cost_count_for_new_method[1] = cost_count_for_new_method[1] + 2;
        XX.append(X0), ZZ.append(Z0);
    X1 = XX[len(XX)-1]; Z1 = ZZ[len(ZZ)-1]; X2 = XX[len(XX)-2]; Z2 = ZZ[len(ZZ)-2]; X3 = XX[len(XX)-3]; Z3 = ZZ[len(ZZ)-3]; 
    #YP = sqrt(XP^3+A*XP^2+XP);
    #PP = E([XP,YP]);
    #PP = (148181920319876519976451218303221399910669970790132986073452550518677899577707757)*PP;
    #print(PP[0]==X1/Z1);
    return X0,Z0;

XP=randint(1,p); XP = G(XP); ZP = G(1); 
[X,Z]=AC_scalar(XP, ZP, A);
if Z == 0:
    print("the new method is correct");
M = 1; S = 0.8;
print("cost of new method:", cost_count_for_new_method[0]*M+cost_count_for_new_method[1]*S);
cost_count = [0,0,0,0,0];
cost_count[2] = cost_count_for_new_method[0];
cost_count[3] = cost_count_for_new_method[1];
print(cost_count);
